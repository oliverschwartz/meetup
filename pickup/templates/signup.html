<!-- templates/signup.html -->
{% extends 'base.html' %}
{% load crispy_forms_tags %}
{% block title %}Sign Up{% endblock %}



{% block content %}
  {% include "header.html" %}

<!-- Signup Form -->
  <h3 class="text-center" style="margin-top: 3%">Welcome! Make your new account here</h3>
  <form class='form-signup' method="post">
    {% csrf_token %}
      <div class="container">
        <div class="row">
        <div class="col-3"></div>
        <div class="col-6 text-center">
            {{ form.username|as_crispy_field }}
        </div>
        </div>
        <div class="row">
        <div class="col-3"></div>
        <div class="col-6 text-center">
            {{ form.email|as_crispy_field }}
        </div>
        </div>
        <div class="row">
        <div class="col-3"></div>
        <div class="col-6 text-center">
            {{ form.first_name|as_crispy_field }}
        </div>
        </div>
        <div class="row">
        <div class="col-3"></div>
        <div class="col-6 text-center">
            {{ form.last_name|as_crispy_field }}
        </div>
        </div>
        <div class="row">
        <div class="col-3"></div>
        <div class="col-6 text-center">
            {{ form.password1|as_crispy_field }}
        </div>
        </div>
        <div class="row">
        <div class="col-3"></div>
        <div class="col-6 text-center">
            {{ form.password2|as_crispy_field }}
        </div>
        </div>
        <div class="text-center">
            <button class='btn btn-primary' type="submit">Sign up</button>
        </div>
  </div>
  </form>
    <div class="text-center" style="margin-top: 2%">
        <a href="{% url 'login' %}">Already have an account? Click here to login!</a>
    </div>
{% endblock %}


{% block js %}
  <script>
    $("#id_username").change(function () {
      var username = $(this).val();

      $.ajax({
        url: '{% url "validate_username" %}',
        data: {
          'username': username
        },
        dataType: 'json',
        success: function (data) {
          if (data.is_taken) {
            document.getElementById("hint_id_username").innerHTML = "<p style='color:red;'>That username is already taken!</p>";
          }
          else {
            document.getElementById("hint_id_username").innerHTML = "Required. 150 characters or fewer. Letters, digits and @/./+/-/_ only.";
          }
        }
      });
    });
  </script>
{% endblock js%}